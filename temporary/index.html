<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Photo API Test</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
      }
      input,
      button {
        margin: 10px 0;
      }
      img {
        max-width: 100%;
        height: 500px;
        width: 500px;
        margin: 10px 0;
        display: block;
      }
      .error {
        color: red;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <h1>Test Photo API</h1>
    <label for="photoId">Enter Object ID:</label>
    <input type="number" id="photoId" placeholder="Enter object ID" />
    <button id="fetchPhoto">Fetch Photos</button>

    <div id="result">
      <p id="error" class="error" style="display: none"></p>
      <div id="photos"></div>
    </div>

    <script>
      document.getElementById("fetchPhoto").addEventListener("click", () => {
        const objectId = document.getElementById("photoId").value; // Введений ID
        const photosContainer = document.getElementById("photos");
        const errorElement = document.getElementById("error");

        // Очистка попередніх результатів
        photosContainer.innerHTML = "";
        errorElement.style.display = "none";

        if (!objectId) {
          errorElement.textContent = "Please enter a valid Object ID!";
          errorElement.style.display = "block";
          return;
        }

        // Виконати запит до API
        const apiUrl = `http://127.0.0.1:5000/api/objects/${objectId}`; // Запит до вашого API
        fetch(apiUrl)
          .then((response) => response.json())
          .then((data) => {
            console.log(data); // Перевірка, що повертається з API

            if (
              data.photos &&
              Array.isArray(data.photos) &&
              data.photos.length > 0
            ) {
              // Вивести всі фото
              data.photos.forEach((photo) => {
                console.log(photo); // Перевірка кожного фото
                const imgElement = document.createElement("img");
                imgElement.src = `data:image/jpeg;base64,${photo.image_base64}`; // Декодуємо base64
                photosContainer.appendChild(imgElement);
              });
            } else {
              errorElement.textContent = "No photos available for this object.";
              errorElement.style.display = "block";
            }
          })
          .catch((error) => {
            console.error("An error occurred:", error);
            errorElement.textContent = "An error occurred while fetching data.";
            errorElement.style.display = "block";
          });
      });
    </script>
  </body>
</html>
